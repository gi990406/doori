{% extends "base.html" %}
{% load static %}
{% block content %}
  <td width="800" valign="top">
    <!-- íƒ€ì´í‹€ -->
    <div id="account-title" aria-label="í˜ì´ì§€ íƒ€ì´í‹€">
      <!-- ê°€ìš´ë° íƒ€ì´í‹€ ì´ë¯¸ì§€ -->
      <div class="title_text">ê²¬ì  ë¬¸ì˜</div>
    </div>
    <!-- ìƒì„¸ ì¹´ë“œ -->
    <div id="quote-detail" class="card">
      <header>
        <h1 class="subject">
          {% if object.is_private %}<span class="lock" title="ë¹„ê³µê°œ">ğŸ”’</span>{% endif %}
          {{ object.title }}
        </h1>
        <div class="meta">
          <span class="badge {% if object.status == 'OPEN' %}open{% elif object.status == 'ANSWERED' %}answered{% else %}closed{% endif %}">
            {{ object.get_status_display }}
          </span>
          <span class="split">Â·</span>
          <span class="author">{{ object.user }}</span>
          <span class="split">Â·</span>
          <time datetime="{{ object.created_at|date:'c' }}">{{ object.created_at|date:"Y-m-d H:i" }}</time>
        </div>
      </header>
      {% if object.attachment %}
        <div class="attach">
          ì²¨ë¶€:
          <a href="{{ object.attachment.url }}">ë‹¤ìš´ë¡œë“œ</a>
        </div>
      {% endif %}
      <article class="content">{{ object.content|safe }}</article>
      {% if user.is_authenticated and user == object.user and object.status != 'CLOSED' %}
        <form method="post"
              action="{% url 'community:close' object.pk %}"
              class="close-wrap">
          {% csrf_token %}
          <button type="submit" class="btn ghost">ë¬¸ì˜ ì¢…ê²°</button>
        </form>
      {% endif %}
    </div>
    <!-- ëŒ“ê¸€ -->
    <div id="comment-block" class="card">
      <h3>ëŒ“ê¸€</h3>
      <ul id="comment-list">
        {% for c in object.comments.all %}
          <li class="item {% if c.is_from_admin %}admin{% endif %}">
            <div class="head">
              <strong class="who">
                {% if c.is_from_admin %}[ê´€ë¦¬ì]{% endif %}
                {{ c.author }}
              </strong>
              <time class="date" datetime="{{ c.created_at|date:'c' }}">{{ c.created_at|date:"Y-m-d H:i" }}</time>
            </div>
            <div class="body">{{ c.content|safe }}</div>
          </li>
        {% empty %}
          <li class="empty">ëŒ“ê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</li>
        {% endfor %}
      </ul>
      {% if user.is_staff %}
        <form method="post"
              action="{% url 'community:comment_create' object.pk %}"
              class="reply-form">
          {% csrf_token %}
          {{ comment_form.media }}
          <div class="form-row">
            {{ comment_form.content }}
            {% for err in comment_form.content.errors %}<p class="err">{{ err }}</p>{% endfor %}
          </div>
          <div class="actions">
            <a class="btn" href="{% url 'community:quotes_list' %}">ëª©ë¡</a>
            <button type="submit" class="btn primary">ë‹µë³€ ë“±ë¡</button>
          </div>
        </form>
      {% else %}
        <div class="actions only-list">
          <a class="btn" href="{% url 'community:quotes_list' %}">ëª©ë¡</a>
        </div>
      {% endif %}
    </div>
  </td>
{% endblock %}
